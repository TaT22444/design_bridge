---
import Layout from '../../layouts/Layout.astro';
import LanguageSwitcher from '../../components/LanguageSwitcher.astro';
import { t } from '../../utils/i18n.ts';

const lang = Astro.url.searchParams.get('lang') || 'ja';

// サンプル学生データ
const studentProfile = {
  name: "田中 花子",
  nameEn: "Hanako Tanaka", 
  university: lang === 'zh-TW' ? "東京設計大學" : "東京デザイン大学",
  year: lang === 'zh-TW' ? "3年級" : "3年生",
  major: lang === 'zh-TW' ? "視覺傳達設計系" : "視覚伝達デザイン学科",
  location: lang === 'zh-TW' ? "東京都" : "東京都",
  bio: lang === 'zh-TW' ? 
    "UI/UXデザインに興味があり、ユーザーの体験を向上させるデザインを学んでいます。地方企業との協働を通じて、実務経験を積み、将来のキャリアに活かしたいと考えています。" :
    "UI/UXデザインに興味があり、ユーザーの体験を向上させるデザインを学んでいます。地方企業との協働を通じて、実務経験を積み、将来のキャリアに活かしたいと考えています。",
  skills: [
    { name: "UI/UX Design", level: 4 },
    { name: "Figma", level: 5 },
    { name: "Adobe XD", level: 3 },
    { name: "Photoshop", level: 4 },
    { name: "Illustrator", level: 3 },
    { name: "HTML/CSS", level: 3 },
    { name: lang === 'zh-TW' ? "用戶研究" : "ユーザーリサーチ", level: 4 },
    { name: lang === 'zh-TW' ? "原型製作" : "プロトタイピング", level: 4 }
  ],
  portfolio: [
    {
      title: lang === 'zh-TW' ? "地方觀光應用程式UI設計" : "地方観光アプリのUI設計",
      type: lang === 'zh-TW' ? "個人作品" : "個人プロジェクト",
      tools: ["Figma", "Adobe XD"],
      image: "/portfolio1.jpg",
      description: lang === 'zh-TW' ? "地方觀光地的資訊提供應用程式的UI設計。重視用戶體驗和地方特色的表現。" : "地方観光地の情報提供アプリのUI設計。ユーザビリティと地域の特色表現にこだわりました。"
    },
    {
      title: lang === 'zh-TW' ? "餐廳預約網站重新設計" : "レストラン予約サイトリデザイン",
      type: lang === 'zh-TW' ? "學校專案" : "学校課題",
      tools: ["Figma", "Photoshop"],
      image: "/portfolio2.jpg", 
      description: lang === 'zh-TW' ? "既存餐廳預約網站的用戶體驗改善。特別關注預約流程的簡化。" : "既存のレストラン予約サイトのUX改善。予約フローの簡素化に重点を置きました。"
    },
    {
      title: lang === 'zh-TW' ? "地方企業品牌識別設計" : "地方企業のブランドアイデンティティ",
      type: lang === 'zh-TW' ? "業務委託" : "業務委託",
      tools: ["Illustrator", "Photoshop"],
      image: "/portfolio3.jpg",
      description: lang === 'zh-TW' ? "熊本縣的老字號和菓子店品牌更新專案。從logo到包裝設計進行了全面更新。" : "熊本県の老舗和菓子店のブランドリニューアル。ロゴからパッケージまで一貫したデザインを提案しました。"
    }
  ],
  experience: [
    {
      title: lang === 'zh-TW' ? "品牌識別設計" : "ブランドアイデンティティ制作",
      company: lang === 'zh-TW' ? "熊本地方創生合作社" : "熊本地方創生協同組合",
      period: "2023年12月 - 2024年1月",
      type: lang === 'zh-TW' ? "業務委託" : "業務委託",
      rate: "¥1,400/時",
      description: lang === 'zh-TW' ? "地方特產品的品牌重新設計。負責logo設計、包裝設計、網站視覺設計等。" : "地方特産品のブランドリニューアル。ロゴデザイン、パッケージデザイン、Webサイトビジュアルを担当。"
    },
    {
      title: lang === 'zh-TW' ? "觀光網站UI改善" : "観光サイトUI改善",
      company: lang === 'zh-TW' ? "大分縣觀光協會" : "大分県観光協会",
      period: "2023年9月 - 2023年11月",
      type: lang === 'zh-TW' ? "實習" : "インターン",
      rate: "¥1,200/時",
      description: lang === 'zh-TW' ? "觀光資訊網站的用戶介面改善。特別關注行動裝置的使用體驗。" : "観光情報サイトのユーザーインターフェース改善。特にモバイルでの利用体験向上に取り組みました。"
    }
  ],
  availability: lang === 'zh-TW' ? "每週20小時" : "週20時間",
  hourlyRate: "¥1,200-1,500/時",
  languages: lang === 'zh-TW' ? ["日本語(ネイティブ)", "英語(中級)", "繁體中文(基礎)"] : ["日本語(ネイティブ)", "英語(中級)", "中国語(基礎)"],
  joinDate: "2023年8月",
  
  // 企業からの評価
  companyEvaluations: [
    {
      company: lang === 'zh-TW' ? "熊本地方創生合作社" : "熊本地方創生協同組合",
      project: lang === 'zh-TW' ? "品牌識別設計" : "ブランドアイデンティティ制作",
      period: "2023年12月 - 2024年1月",
      overallRating: 4.5,
      skillRatings: {
        design: 5,      // デザイン力
        communication: 4, // コミュニケーション
        deadline: 5,    // 締切管理
        creativity: 4,  // 創造性
        professionalism: 4 // プロ意識
      },
      comment: lang === 'zh-TW' ? 
        "デザインセンスが優秀で、クライアントの要望を的確に理解し、期待以上の成果物を納期内に完成させてくれました。コミュニケーションも円滑で、安心してお任せできる学生さんです。" :
        "デザインセンスが優秀で、クライアントの要望を的確に理解し、期待以上の成果物を納期内に完成させてくれました。コミュニケーションも円滑で、安心してお任せできる学生さんです。"
    },
    {
      company: lang === 'zh-TW' ? "大分縣觀光協會" : "大分県観光協会",
      project: lang === 'zh-TW' ? "觀光網站UI改善" : "観光サイトUI改善",
      period: "2023年9月 - 2023年11月",
      overallRating: 4.2,
      skillRatings: {
        design: 4,
        communication: 4,
        deadline: 4,
        creativity: 5,
        professionalism: 4
      },
      comment: lang === 'zh-TW' ? 
        "モバイルファーストの視点で既存サイトの問題点を的確に分析し、実用的かつ魅力的な改善案を提案してくれました。若い感性を活かした新鮮なアイデアが印象的でした。" :
        "モバイルファーストの視点で既存サイトの問題点を的確に分析し、実用的かつ魅力的な改善案を提案してくれました。若い感性を活かした新鮮なアイデアが印象的でした。"
    }
  ]
};

// 企業評価の平均スコア計算
const avgSkillRatings = {
  design: studentProfile.companyEvaluations.reduce((sum, evaluation) => sum + evaluation.skillRatings.design, 0) / studentProfile.companyEvaluations.length,
  communication: studentProfile.companyEvaluations.reduce((sum, evaluation) => sum + evaluation.skillRatings.communication, 0) / studentProfile.companyEvaluations.length,
  deadline: studentProfile.companyEvaluations.reduce((sum, evaluation) => sum + evaluation.skillRatings.deadline, 0) / studentProfile.companyEvaluations.length,
  creativity: studentProfile.companyEvaluations.reduce((sum, evaluation) => sum + evaluation.skillRatings.creativity, 0) / studentProfile.companyEvaluations.length,
  professionalism: studentProfile.companyEvaluations.reduce((sum, evaluation) => sum + evaluation.skillRatings.professionalism, 0) / studentProfile.companyEvaluations.length
};

const avgOverallRating = studentProfile.companyEvaluations.reduce((sum, evaluation) => sum + evaluation.overallRating, 0) / studentProfile.companyEvaluations.length;
---

<Layout title={`${lang === 'zh-TW' ? '學生檔案' : '学生プロフィール'} | DesignBridge`}>
  <div class="min-h-screen bg-gray-50">
    <!-- ナビゲーション -->
    <nav class="bg-white border-b border-gray-200 sticky top-0 z-50">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center h-16">
          <div class="flex items-center">
            <a href={`/?lang=${lang}`} class="text-xl font-semibold text-gray-900">
              DesignBridge
            </a>
            <span class="ml-3 text-sm text-gray-500">{t('nav.students', lang)}</span>
          </div>
          <div class="flex items-center space-x-6">
            <LanguageSwitcher />
            <a href={`/student?lang=${lang}`} class="text-sm text-gray-600 hover:text-gray-900">{lang === 'zh-TW' ? '專案列表' : 'プロジェクト一覧'}</a>
            <button class="text-sm text-gray-600 hover:text-gray-900">{t('nav.applications', lang)}</button>
            <button class="bg-gray-900 hover:bg-gray-800 text-white px-4 py-2 rounded-md text-sm font-medium">{t('nav.logout', lang)}</button>
          </div>
        </div>
      </div>
    </nav>

    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
        <!-- プロフィール情報 -->
        <div class="lg:col-span-1">
          <div class="bg-white border border-gray-200 rounded-lg p-6 mb-6">
            <!-- プロフィール写真とbasic info -->
            <div class="text-center mb-6">
              <div class="w-24 h-24 bg-gray-200 rounded-full mx-auto mb-4 flex items-center justify-center">
                <svg class="w-12 h-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                </svg>
              </div>
              <h1 class="text-xl font-semibold text-gray-900 mb-1">{studentProfile.name}</h1>
              <p class="text-gray-600 text-sm">{studentProfile.nameEn}</p>
              <div class="mt-3 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs bg-gray-100 text-gray-800">
                {lang === 'zh-TW' ? '學生會員' : '学生会員'}
              </div>
            </div>

            <!-- 基本情報 -->
            <div class="space-y-4 text-sm">
              <div>
                <span class="font-medium text-gray-900">{lang === 'zh-TW' ? '大學' : '大学'}</span>
                <p class="text-gray-600 mt-1">{studentProfile.university}</p>
              </div>
              <div>
                <span class="font-medium text-gray-900">{lang === 'zh-TW' ? '學年' : '学年'}</span>
                <p class="text-gray-600 mt-1">{studentProfile.year}</p>
              </div>
              <div>
                <span class="font-medium text-gray-900">{lang === 'zh-TW' ? '專業' : '専攻'}</span>
                <p class="text-gray-600 mt-1">{studentProfile.major}</p>
              </div>
              <div>
                <span class="font-medium text-gray-900">{lang === 'zh-TW' ? '居住地' : '居住地'}</span>
                <p class="text-gray-600 mt-1">{studentProfile.location}</p>
              </div>
              <div>
                <span class="font-medium text-gray-900">{lang === 'zh-TW' ? '可工作時間' : '稼働可能時間'}</span>
                <p class="text-gray-600 mt-1">{studentProfile.availability}</p>
              </div>
              <div>
                <span class="font-medium text-gray-900">{lang === 'zh-TW' ? '希望時薪' : '希望時給'}</span>
                <p class="text-gray-600 mt-1">{studentProfile.hourlyRate}</p>
              </div>
            </div>

            <!-- 言語スキル -->
            <div class="mt-6 pt-6 border-t border-gray-200">
              <h3 class="font-medium text-gray-900 mb-3">{lang === 'zh-TW' ? '語言能力' : '言語スキル'}</h3>
              <div class="space-y-2">
                {studentProfile.languages.map(language => (
                  <div class="text-sm text-gray-600">{language}</div>
                ))}
              </div>
            </div>

            <!-- 登録日 -->
            <div class="mt-6 pt-6 border-t border-gray-200 text-sm text-gray-500">
              {lang === 'zh-TW' ? '加入日期' : '登録日'}: {studentProfile.joinDate}
            </div>
          </div>

          <!-- アクションボタン -->
          <div class="space-y-3">
            <button class="w-full bg-gray-900 hover:bg-gray-800 text-white py-2 px-4 rounded-md text-sm font-medium">
              {lang === 'zh-TW' ? '聯繫學生' : '学生に連絡'}
            </button>
            <button class="w-full border border-gray-300 text-gray-700 hover:bg-gray-50 py-2 px-4 rounded-md text-sm font-medium">
              {lang === 'zh-TW' ? '查看完整作品集' : 'ポートフォリオを見る'}
            </button>
          </div>
        </div>

        <!-- メインコンテンツ -->
        <div class="lg:col-span-2 space-y-6">
          <!-- 自己紹介 -->
          <div class="bg-white border border-gray-200 rounded-lg p-6">
            <h2 class="text-lg font-semibold text-gray-900 mb-4">{lang === 'zh-TW' ? '自我介紹' : '自己紹介'}</h2>
            <p class="text-gray-600 leading-relaxed">{studentProfile.bio}</p>
          </div>

          <!-- スキル -->
          <div class="bg-white border border-gray-200 rounded-lg p-6">
            <h2 class="text-lg font-semibold text-gray-900 mb-4">{lang === 'zh-TW' ? '技能' : 'スキル'}</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              {studentProfile.skills.map(skill => (
                <div class="flex items-center justify-between">
                  <span class="text-sm font-medium text-gray-900">{skill.name}</span>
                  <div class="flex items-center space-x-1">
                    {[1, 2, 3, 4, 5].map(level => (
                      <div class={`w-2 h-2 rounded-full ${level <= skill.level ? 'bg-gray-900' : 'bg-gray-200'}`}></div>
                    ))}
                  </div>
                </div>
              ))}
            </div>
          </div>

          <!-- ポートフォリオ -->
          <div class="bg-white border border-gray-200 rounded-lg p-6">
            <h2 class="text-lg font-semibold text-gray-900 mb-4">{lang === 'zh-TW' ? '作品集精選' : 'ポートフォリオ'}</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              {studentProfile.portfolio.map(project => (
                <div class="border border-gray-200 rounded-lg overflow-hidden">
                  <div class="aspect-video bg-gray-100 flex items-center justify-center">
                    <svg class="w-12 h-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                    </svg>
                  </div>
                  <div class="p-4">
                    <div class="flex items-center justify-between mb-2">
                      <h3 class="font-medium text-gray-900 text-sm">{project.title}</h3>
                      <span class="inline-flex items-center px-2 py-1 rounded text-xs bg-gray-100 text-gray-700">
                        {project.type}
                      </span>
                    </div>
                    <p class="text-gray-600 text-xs mb-3 leading-relaxed">{project.description}</p>
                    <div class="flex flex-wrap gap-1">
                      {project.tools.map(tool => (
                        <span class="inline-flex items-center px-2 py-1 rounded text-xs bg-gray-100 text-gray-700">
                          {tool}
                        </span>
                      ))}
                    </div>
                  </div>
                </div>
              ))}
            </div>
          </div>

          <!-- 実務経験 -->
          <div class="bg-white border border-gray-200 rounded-lg p-6">
            <h2 class="text-lg font-semibold text-gray-900 mb-4">{lang === 'zh-TW' ? '實務經驗' : '実務経験'}</h2>
            <div class="space-y-6">
              {studentProfile.experience.map(exp => (
                <div class="border-l-2 border-gray-200 pl-4">
                  <div class="flex items-start justify-between mb-2">
                    <div>
                      <h3 class="font-medium text-gray-900">{exp.title}</h3>
                      <p class="text-sm text-gray-600">{exp.company}</p>
                    </div>
                    <div class="text-right">
                      <span class="inline-flex items-center px-2 py-1 rounded text-xs bg-gray-100 text-gray-700">
                        {exp.type}
                      </span>
                      <p class="text-xs text-gray-500 mt-1">{exp.rate}</p>
                    </div>
                  </div>
                  <p class="text-xs text-gray-500 mb-2">{exp.period}</p>
                  <p class="text-sm text-gray-600 leading-relaxed">{exp.description}</p>
                </div>
              ))}
            </div>
          </div>

          <!-- 企業からの評価 -->
          <div class="bg-white border border-gray-200 rounded-lg p-6">
            <h2 class="text-lg font-semibold text-gray-900 mb-4">{lang === 'zh-TW' ? '企業評價' : '企業からの評価'}</h2>
            
            <!-- 総合評価 -->
            <div class="bg-gray-50 rounded-lg p-4 mb-6">
              <div class="text-center">
                <div class="text-3xl font-bold text-gray-900 mb-1">
                  {avgOverallRating.toFixed(1)}
                </div>
                <div class="flex justify-center items-center mb-2">
                  {[1, 2, 3, 4, 5].map(star => (
                    <svg class={`w-5 h-5 ${star <= Math.round(avgOverallRating) ? 'text-gray-900' : 'text-gray-300'}`} fill="currentColor" viewBox="0 0 20 20">
                      <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
                    </svg>
                  ))}
                </div>
                <p class="text-sm text-gray-600">{lang === 'zh-TW' ? '總體評價' : '総合評価'} ({studentProfile.companyEvaluations.length}{lang === 'zh-TW' ? '個專案' : 'プロジェクト'})</p>
              </div>
            </div>

            <!-- スキル評価レーダーチャート風 -->
            <div class="mb-6">
              <h3 class="font-medium text-gray-900 mb-4">{lang === 'zh-TW' ? '技能評分' : 'スキル評価'}</h3>
              <div class="space-y-3">
                <div class="flex items-center justify-between">
                  <span class="text-sm font-medium text-gray-700">{lang === 'zh-TW' ? '設計能力' : 'デザイン力'}</span>
                  <div class="flex items-center space-x-2">
                    <div class="w-32 bg-gray-200 rounded-full h-2">
                      <div class="bg-gray-900 h-2 rounded-full" style={`width: ${(avgSkillRatings.design / 5) * 100}%`}></div>
                    </div>
                    <span class="text-sm font-medium text-gray-900 w-8">{avgSkillRatings.design.toFixed(1)}</span>
                  </div>
                </div>
                <div class="flex items-center justify-between">
                  <span class="text-sm font-medium text-gray-700">{lang === 'zh-TW' ? '溝通能力' : 'コミュニケーション'}</span>
                  <div class="flex items-center space-x-2">
                    <div class="w-32 bg-gray-200 rounded-full h-2">
                      <div class="bg-gray-900 h-2 rounded-full" style={`width: ${(avgSkillRatings.communication / 5) * 100}%`}></div>
                    </div>
                    <span class="text-sm font-medium text-gray-900 w-8">{avgSkillRatings.communication.toFixed(1)}</span>
                  </div>
                </div>
                <div class="flex items-center justify-between">
                  <span class="text-sm font-medium text-gray-700">{lang === 'zh-TW' ? '時程管理' : '締切管理'}</span>
                  <div class="flex items-center space-x-2">
                    <div class="w-32 bg-gray-200 rounded-full h-2">
                      <div class="bg-gray-900 h-2 rounded-full" style={`width: ${(avgSkillRatings.deadline / 5) * 100}%`}></div>
                    </div>
                    <span class="text-sm font-medium text-gray-900 w-8">{avgSkillRatings.deadline.toFixed(1)}</span>
                  </div>
                </div>
                <div class="flex items-center justify-between">
                  <span class="text-sm font-medium text-gray-700">{lang === 'zh-TW' ? '創造力' : '創造性'}</span>
                  <div class="flex items-center space-x-2">
                    <div class="w-32 bg-gray-200 rounded-full h-2">
                      <div class="bg-gray-900 h-2 rounded-full" style={`width: ${(avgSkillRatings.creativity / 5) * 100}%`}></div>
                    </div>
                    <span class="text-sm font-medium text-gray-900 w-8">{avgSkillRatings.creativity.toFixed(1)}</span>
                  </div>
                </div>
                <div class="flex items-center justify-between">
                  <span class="text-sm font-medium text-gray-700">{lang === 'zh-TW' ? '專業態度' : 'プロ意識'}</span>
                  <div class="flex items-center space-x-2">
                    <div class="w-32 bg-gray-200 rounded-full h-2">
                      <div class="bg-gray-900 h-2 rounded-full" style={`width: ${(avgSkillRatings.professionalism / 5) * 100}%`}></div>
                    </div>
                    <span class="text-sm font-medium text-gray-900 w-8">{avgSkillRatings.professionalism.toFixed(1)}</span>
                  </div>
                </div>
              </div>
            </div>

            <!-- 個別の評価コメント -->
            <div class="space-y-4">
              <h3 class="font-medium text-gray-900">{lang === 'zh-TW' ? '客戶評語' : 'クライアントからの評価'}</h3>
              {studentProfile.companyEvaluations.map(evaluation => (
                <div class="border border-gray-200 rounded-lg p-4">
                  <div class="flex items-start justify-between mb-3">
                    <div>
                      <h4 class="font-medium text-gray-900">{evaluation.company}</h4>
                      <p class="text-sm text-gray-600">{evaluation.project}</p>
                      <p class="text-xs text-gray-500">{evaluation.period}</p>
                    </div>
                    <div class="text-right">
                      <div class="flex items-center space-x-1">
                        {[1, 2, 3, 4, 5].map(star => (
                          <svg class={`w-4 h-4 ${star <= Math.round(evaluation.overallRating) ? 'text-gray-900' : 'text-gray-300'}`} fill="currentColor" viewBox="0 0 20 20">
                            <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
                          </svg>
                        ))}
                      </div>
                      <p class="text-sm font-medium text-gray-900">{evaluation.overallRating}</p>
                    </div>
                  </div>
                  <p class="text-sm text-gray-600 leading-relaxed">{evaluation.comment}</p>
                </div>
              ))}
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</Layout> 